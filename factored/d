clc
clear all
close all

%-----------------------------------------------------------------
F = 2/3 * [ 1/sqrt(2) 1/sqrt(2) 1/sqrt(2) ; 1 -1/2 -1/2 ; 0 -sqrt(3)/2 sqrt(3)/2 ];
MTab = F;
%-----------------------------------------------------------------

%-----------------------------------------------------------------
TS_Control     = 50e-6;
%-----------------------------------------------------------------

%-----------------------------------------------------------------
% PLL OBSERVADOR DISCRETO
%-----------------------------------------------------------------
wB = 2*pi*50;
I = eye(2,2);
J = [ 0 1 ; -1 0 ];

 JeN  = blkdiag( 0*J , 1*J , -1*J , 5*J , -5*J , 7*J , -7*J , 11*J , -11*J , 13*J , -13*J );       
 COBN = [ I , I I , I I , I I , I I , I I ];
%JeN  = blkdiag( 1*J , -1*J , 5*J , -5*J , 7*J , -7*J );       
%COBN = [ I I , I I , I I ];

AODN = expm(wB*JeN*TS_Control);
CODN = COBN;    
    
Q   = 10*diag([ 50*[ 1 1 ] , 50*ones(1,4) 10*ones(1,4) 2*ones(1,4) 0.8*ones(1,4) 0.5*ones(1,4) ]);   R = diag([1 1]);
 Q = diag([ 1.5*[ 1 1 ] , 1.5*[ 1 1 ] , ones(1,size(AODN,1)-2-2) ]);   R = 25*diag([1 1]);
%Q = diag([ 1.5*[ 1 1 ] , ones(1,size(AODN,1)-2) ]);   R = 25*diag([1 1]);

GODN = dlqr(AODN',CODN',Q,R).';
eig(AODN-GODN*CODN);
%-----------------------------------------------------------------
Q0N = AODN;
%-----------------------------------------------------------------
NxN = size(JeN,1);
X0N = [ 0 1 , 0 0 , zeros(1,NxN-4) ].';
%-----------------------------------------------------------------

invMTab=inv(MTab);
